"use strict";function getKey(e){return self.crypto.subtle.importKey("raw",strToArray(e),{name:"PBKDF2"},!1,["deriveKey"]).then(function(e){return self.crypto.subtle.deriveKey({name:"PBKDF2",salt:saltArr,iterations:500,hash:"SHA-256"},e,{name:"AES-CBC",length:256},!1,["decrypt"])}).then(function(e){return Promise.all([e,decipher(e,testEncryptedData)])}).then(function(e){if(arrayToStr(new Uint8Array(e[1]))===testEncryptedPlainText)return e[0]}).catch(function(e){console.error(e)})}function decipher(e,r){return self.crypto.subtle.decrypt({name:"AES-CBC",iv:ivArr},e,r)}function hexToArray(e){for(var r=new Uint8Array(e.length/2),t=0;t<e.length;t+=2)r[t/2]=parseInt(e.charAt(t)+e.charAt(t+1),16);return r}function strToArray(e){return Uint8Array.from(unescape(encodeURIComponent(e)).split("").map(function(e){return e.charCodeAt(0)}))}function arrayToStr(e){return decodeURIComponent(escape(Array.prototype.map.call(e,function(e){return String.fromCharCode(e)}).join("")))}function getFile(e){var r=new XMLHttpRequest;return r.responseType="arraybuffer",r.open("GET",e),r.send(null),new Promise(function(e,t){r.onloadend=function(){404===r.status?e(""):r.response?e(r.response):t(r.error)}})}var saltArr=hexToArray("79f9ff63bf690f0c4640a8fce3bc3d6e"),ivArr=hexToArray("c9567d08a04248a3202e7a5541ff9cf0"),testEncryptedData=hexToArray("ab7334b313ea8e5333a1db44dd782e59"),testEncryptedPlainText="testvalue",encryptedDOMSteps="/cv/steps.json.aes?_=67f271",encryptedPrivatePDF="/cv/timdream-private.pdf.aes?_=2b8a7b";self.onmessage=function(e){var r=e.data.password;Promise.all([getKey(r),getFile(encryptedDOMSteps),getFile(encryptedPrivatePDF)]).then(function(e){var r=e[0],t=e[1],n=e[2];if(!r)throw"Incorrect Password.";return Promise.all([decipher(r,t),decipher(r,n)])}).then(function(e){self.postMessage({type:"result",domModifications:JSON.parse(arrayToStr(new Uint8Array(e[0]))),privatePDFBlob:new Blob([e[1]],{type:"application/pdf"})})}).catch(function(e){console.error(e),"string"==typeof e?self.postMessage({type:"result",error:e}):self.postMessage({type:"error",message:message})})};
//# sourceMappingURL=webcrypto-decipher.min.js.map