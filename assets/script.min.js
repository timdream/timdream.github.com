"use strict";if(document.documentElement.classList.remove("no-js"),"timdream.org"===window.location.hostname&&"1"!==window.doNotTrack&&"1"!==navigator.doNotTrack){var _paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="//stats.timdream.org/";_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var t=document,s=t.createElement("script"),i=t.getElementsByTagName("script")[0];s.type="text/javascript",s.async=!0,s.defer=!0,s.src=e+"matomo.js",i.parentNode.insertBefore(s,i)}()}function ServiceWorkerController(){}function PicMotion(){}ServiceWorkerController.prototype={start:function(){"serviceWorker"in navigator?this.check().then(function(){return this.swReg&&(this.swReg.installing||this.swReg.waiting||this.swReg.active)?this.swReg.active?this.swReg.update():void 0:this.install()}.bind(this)).then(function(){this.swReg.addEventListener("updatefound",this),this.showUpdateProgress()}.bind(this)).catch(function(e){console.log(e)}.bind(this)):this.state="notsupported"},check:function(){return navigator.serviceWorker.getRegistration("/").then(function(e){this.swReg=e}.bind(this))},install:function(){return navigator.serviceWorker.register("/service-worker.min.js",{scope:"/"}).then(function(e){this.swReg=e}.bind(this))},remove:function(){this.state="removing",this.swReg.unregister().then(function(e){e?(this.state="uninstalled",this.swReg=null):this.state="installed"}.bind(this))},showUpdateProgress:function(){this.swReg.installing&&navigator.serviceWorker.controller&&(document.documentElement.classList.add("updating"),this.swReg.installing.addEventListener("statechange",this))},handleEvent:function(e){switch(e.type){case"updatefound":this.showUpdateProgress();break;case"statechange":if(e.target.removeEventListener("statechange",this),"redundant"===e.target.state)return void document.documentElement.classList.remove("updating");window.location.reload()}}},window.swController=new ServiceWorkerController,window.swController.start(),window.addEventListener("pagehide",function(){document.body.classList.add("pagehide")}),window.addEventListener("pageshow",function(){document.body.classList.remove("pagehide")}),PicMotion.prototype={MAX_DEG_MOUSE:20,MAX_DEG_TOUCH:10,SCENE_Z_DIST:30,FOREGROUND_Z_DIST:-10,start:function(){var e=this.areaEl=document.getElementById("motion-pic");if(e){var t=this.foregroundEl=document.createElement("img");t.className="pic-foreground",t.src="/assets/reading-signpost-in-paris-foreground.png?_=42be09";var s=this.sceneEl=document.createElement("img");s.className="pic-scene",s.src="/assets/reading-signpost-in-paris-scene.jpg?_=39d0e9",e.insertBefore(t,e.firstChild),e.insertBefore(s,e.firstChild),e.addEventListener("touchstart",this,{passive:!0}),e.addEventListener("touchmove",this,{passive:!0}),e.addEventListener("touchend",this,{passive:!0}),e.addEventListener("touchcancel",this,{passive:!0}),e.addEventListener("mousemove",this,{passive:!0}),e.addEventListener("mouseleave",this,{passive:!0}),e.classList.add("motion")}},handleEvent:function(e){switch(e.type){case"touchstart":this.areaEl.removeEventListener("mousemove",this,{passive:!0}),this.areaEl.removeEventListener("mouseleave",this,{passive:!0});break;case"touchmove":var t=2*this.MAX_DEG_TOUCH*(e.touches[0].clientX-window.innerWidth/2)/window.innerWidth,s=-2*this.MAX_DEG_TOUCH*(e.touches[0].clientY-window.innerHeight/2)/window.innerHeight;this.scheduleMotionUpdate(t,s);break;case"mousemove":t=2*this.MAX_DEG_MOUSE*((e.offsetX-150)/300),s=-2*this.MAX_DEG_MOUSE*((e.offsetY-150)/300);this.scheduleMotionUpdate(t,s);break;case"mouseleave":case"touchend":case"touchcancel":this.scheduleMotionEnd()}},scheduleMotionUpdate:function(e,t){this.scheduleStyleChange(function(){this.areaEl.classList.add("active");var s="rotateX("+t+"deg) rotateY("+e+"deg)";this.foregroundEl.style.transform=s+" translateZ("+this.SCENE_Z_DIST+"px)",this.sceneEl.style.transform=s+" translateZ("+this.FOREGROUND_Z_DIST+"px)"}.bind(this))},scheduleMotionEnd(){this.scheduleStyleChange(function(){this.areaEl.classList.remove("active"),this.foregroundEl.style.transform="",this.sceneEl.style.transform=""}.bind(this))},scheduleStyleChange:function(e){(window.cancelAnimationFrame||window.clearTimeout)(this.reqId),this.reqId=(window.requestAnimationFrame||window.setTimeout)(e)}},window.picMotion=new PicMotion,window.picMotion.start();
//# sourceMappingURL=script.min.js.map